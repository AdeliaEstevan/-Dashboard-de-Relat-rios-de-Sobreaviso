<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCADA Analytics | Energisa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1/dist/chartjs-adapter-luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* TODOS OS ESTILOS ORIGINAIS MANTIDOS - MESMO CSS DO ARQUIVO ORIGINAL */
        :root {
            --primary-color: #1a365d;
            --secondary-color: #2b6cb0;
            --accent-color: #e53e3e;
            --success-color: #38a169;
            --warning-color: #dd6b20;
            --info-color: #3182ce;
            --dark-bg: #0f1419;
            --card-bg: #1e2328;
            --sidebar-bg: #151a21;
            --text-light: #f7fafc;
            --text-muted: #a0aec0;
            --energisa-blue: #1a75bc;
            --energisa-green: #00a859;
            --gradient-primary: linear-gradient(135deg, #1a365d, #2d3748);
            --gradient-secondary: linear-gradient(135deg, #2b6cb0, #3182ce);
            --gradient-success: linear-gradient(135deg, #38a169, #48bb78);
            --gradient-accent: linear-gradient(135deg, #e53e3e, #f56565);
            --gradient-warning: linear-gradient(135deg, #dd6b20, #ed8936);
            --shadow-light: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 10px 15px rgba(0, 0, 0, 0.2);
            --shadow-large: 0 20px 25px rgba(0, 0, 0, 0.3);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-light);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Layout Principal */
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            padding: 1.5rem 1rem;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transition: var(--transition);
            box-shadow: var(--shadow-medium);
        }
        
        .sidebar.collapsed {
            width: 70px;
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding: 0 0.5rem;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .logo-icon {
            background: var(--energisa-blue);
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        
        .logo-text {
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--text-light);
        }
        
        .sidebar.collapsed .logo-text {
            display: none;
        }
        
        .toggle-sidebar {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.2rem;
            transition: var(--transition);
        }
        
        .toggle-sidebar:hover {
            color: var(--text-light);
        }
        
        .sidebar.collapsed .toggle-sidebar {
            transform: rotate(180deg);
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
            padding: 0 0.5rem;
        }
        
        .sidebar.collapsed .nav-title {
            display: none;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 0.5rem;
            border-radius: 8px;
            color: var(--text-muted);
            text-decoration: none;
            transition: var(--transition);
            margin-bottom: 0.25rem;
            cursor: pointer;
        }
        
        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-light);
        }
        
        .nav-item.active {
            background: var(--gradient-secondary);
            color: white;
        }
        
        .nav-icon {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .sidebar.collapsed .nav-text {
            display: none;
        }
        
        /* Conteúdo Principal */
        .main-content {
            flex: 1;
            margin-left: 260px;
            transition: var(--transition);
            padding: 1.5rem 2rem;
        }
        
        .main-content.expanded {
            margin-left: 70px;
        }
        
        /* Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .page-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-light);
        }
        
        .page-subtitle {
            font-size: 1rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .user-profile:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gradient-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .user-role {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        
        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: none;
            transition: var(--transition);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .card-header {
            background: transparent;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.25rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .card-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .card-icon {
            color: var(--energisa-blue);
            font-size: 1.2rem;
        }
        
        .card-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .card-action {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .card-action:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-light);
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .kpi-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
            position: relative;
            overflow: hidden;
        }
        
        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }
        
        .kpi-card.primary::before {
            background: var(--gradient-primary);
        }
        
        .kpi-card.secondary::before {
            background: var(--gradient-secondary);
        }
        
        .kpi-card.success::before {
            background: var(--gradient-success);
        }
        
        .kpi-card.accent::before {
            background: var(--gradient-accent);
        }
        
        .kpi-card.warning::before {
            background: var(--gradient-warning);
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .kpi-title {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
        }
        
        .kpi-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: white;
        }
        
        .kpi-card.primary .kpi-icon {
            background: var(--gradient-primary);
        }
        
        .kpi-card.secondary .kpi-icon {
            background: var(--gradient-secondary);
        }
        
        .kpi-card.success .kpi-icon {
            background: var(--gradient-success);
        }
        
        .kpi-card.accent .kpi-icon {
            background: var(--gradient-accent);
        }
        
        .kpi-card.warning .kpi-icon {
            background: var(--gradient-warning);
        }
        
        .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .kpi-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }
        
        .trend-up {
            color: var(--success-color);
        }
        
        .trend-down {
            color: var(--accent-color);
        }
        
        .kpi-footer {
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 1.5rem;
        }
        
        .grid-col-4 {
            grid-column: span 4;
        }
        
        .grid-col-6 {
            grid-column: span 6;
        }
        
        .grid-col-8 {
            grid-column: span 8;
        }
        
        .grid-col-12 {
            grid-column: span 12;
        }
        
        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* File Upload */
        .file-upload-area {
            background: var(--card-bg);
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            padding: 2.5rem 2rem;
            text-align: center;
            transition: var(--transition);
            margin-bottom: 2rem;
        }
        
        .file-upload-area:hover {
            border-color: var(--energisa-blue);
        }
        
        .file-upload-area.active {
            border-color: var(--energisa-blue);
            background: rgba(26, 117, 188, 0.05);
        }
        
        .upload-icon {
            font-size: 3rem;
            color: var(--energisa-blue);
            margin-bottom: 1rem;
        }
        
        .upload-text {
            margin-bottom: 1.5rem;
        }
        
        .upload-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .upload-subtitle {
            color: var(--text-muted);
        }
        
        /* Filtros */
        .filter-panel {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-light);
        }
        
        .filter-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        
        .filter-title {
            font-weight: 600;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .filter-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .form-control, .form-select {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            transition: var(--transition);
        }
        
        .form-control:focus, .form-select:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--energisa-blue);
            color: var(--text-light);
            box-shadow: 0 0 0 0.25rem rgba(26, 117, 188, 0.25);
        }
        
        .btn {
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            transition: var(--transition);
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: var(--gradient-secondary);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }
        
        .btn-outline-light {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-light);
        }
        
        .btn-outline-light:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Alertas */
        .alert {
            border-radius: var(--border-radius);
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            border: none;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .alert-icon {
            font-size: 1.5rem;
        }
        
        .alert-info {
            background: rgba(49, 130, 206, 0.1);
            color: var(--info-color);
            border-left: 4px solid var(--info-color);
        }
        
        .alert-success {
            background: rgba(56, 161, 105, 0.1);
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }
        
        .alert-warning {
            background: rgba(221, 107, 32, 0.1);
            color: var(--warning-color);
            border-left: 4px solid var(--warning-color);
        }
        
        .alert-danger {
            background: rgba(229, 62, 62, 0.1);
            color: var(--accent-color);
            border-left: 4px solid var(--accent-color);
        }
        
        /* Tabelas */
        .table-container {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }
        
        .table {
            margin-bottom: 0;
            color: var(--text-light);
        }
        
        .table-dark {
            background: var(--card-bg);
        }
        
        .table > thead {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .table > thead > tr > th {
            border: none;
            background: rgba(255, 255, 255, 0.03);
            padding: 1rem 1.5rem;
            font-weight: 600;
            color: var(--text-muted);
        }
        
        .table > tbody > tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }
        
        .table > tbody > tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .table > tbody > tr > td {
            border: none;
            padding: 1rem 1.5rem;
            vertical-align: middle;
        }
        
        .badge {
            font-weight: 500;
            padding: 0.35rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
        }
        
        /* Abas */
        .nav-tabs {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0 1.5rem;
        }
        
        .nav-tabs .nav-link {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 1rem 1.5rem;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .nav-tabs .nav-link:hover {
            color: var(--text-light);
            border-bottom-color: rgba(255, 255, 255, 0.2);
        }
        
        .nav-tabs .nav-link.active {
            color: var(--energisa-blue);
            border-bottom-color: var(--energisa-blue);
            background: transparent;
        }
        
        .tab-content {
            padding: 1.5rem;
        }
        
        /* Insights */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .insight-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            display: flex;
            gap: 1rem;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
        }
        
        .insight-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        .insight-icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .insight-positive .insight-icon {
            background: rgba(56, 161, 105, 0.1);
            color: var(--success-color);
        }
        
        .insight-warning .insight-icon {
            background: rgba(221, 107, 32, 0.1);
            color: var(--warning-color);
        }
        
        .insight-negative .insight-icon {
            background: rgba(229, 62, 62, 0.1);
            color: var(--accent-color);
        }
        
        .insight-info .insight-icon {
            background: rgba(49, 130, 206, 0.1);
            color: var(--info-color);
        }
        
        .insight-content {
            flex: 1;
        }
        
        .insight-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .insight-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Loading */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 3rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--energisa-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsividade */
        @media (max-width: 1200px) {
            .grid-col-4, .grid-col-6, .grid-col-8 {
                grid-column: span 12;
            }
            
            .sidebar {
                width: 70px;
            }
            
            .sidebar .logo-text,
            .sidebar .nav-text,
            .sidebar .nav-title {
                display: none;
            }
            
            .main-content {
                margin-left: 70px;
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Utilitários */
        .text-success {
            color: var(--success-color) !important;
        }
        
        .text-warning {
            color: var(--warning-color) !important;
        }
        
        .text-danger {
            color: var(--accent-color) !important;
        }
        
        .text-info {
            color: var(--info-color) !important;
        }
        
        .mb-0 {
            margin-bottom: 0 !important;
        }
        
        .mt-2 {
            margin-top: 0.5rem !important;
        }
        
        .mt-3 {
            margin-top: 1rem !important;
        }
        
        .mt-4 {
            margin-top: 1.5rem !important;
        }
        
        .mb-2 {
            margin-bottom: 0.5rem !important;
        }
        
        .mb-3 {
            margin-bottom: 1rem !important;
        }
        
        .mb-4 {
            margin-bottom: 1.5rem !important;
        }
        
        .d-flex {
            display: flex !important;
        }
        
        .justify-content-between {
            justify-content: space-between !important;
        }
        
        .align-items-center {
            align-items: center !important;
        }
        
        .w-100 {
            width: 100% !important;
        }
        
        .text-center {
            text-align: center !important;
        }
        
        .text-right {
            text-align: right !important;
        }
        
        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Scrollbar personalizado */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Conteúdo das abas */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Modal de pré-visualização do PDF */
        .pdf-preview-modal .modal-content {
            background-color: #f8f9fa;
            color: #333;
        }
        
        .pdf-preview {
            background: white;
            color: #333;
            padding: 2rem;
            border-radius: 8px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .pdf-preview h1 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--energisa-blue);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .pdf-preview h2 {
            color: var(--secondary-color);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .pdf-preview .chart-preview {
            margin: 1.5rem 0;
            padding: 1rem;
            background: #f5f5f5;
            border-radius: 8px;
            text-align: center;
        }
        
        .pdf-preview .chart-preview img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .pdf-preview .summary-section {
            margin: 1.5rem 0;
            padding: 1rem;
            background: #f0f8ff;
            border-radius: 8px;
            border-left: 4px solid var(--energisa-blue);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="logo-text">Energisa Analytics</div>
                </div>
                <button class="toggle-sidebar">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Principal</div>
                <a href="#" class="nav-item active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt nav-icon"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-tab="relatorios">
                    <i class="fas fa-chart-bar nav-icon"></i>
                    <span class="nav-text">Relatórios</span>
                </a>
                <a href="#" class="nav-item" data-tab="configuracoes">
                    <i class="fas fa-cog nav-icon"></i>
                    <span class="nav-text">Configurações</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Análises</div>
                <a href="#" class="nav-item" data-tab="filtros">
                    <i class="fas fa-filter nav-icon"></i>
                    <span class="nav-text">Filtros Avançados</span>
                </a>
                <a href="#" class="nav-item" data-tab="tendencias">
                    <i class="fas fa-chart-line nav-icon"></i>
                    <span class="nav-text">Tendências</span>
                </a>
                <a href="#" class="nav-item" data-tab="performance">
                    <i class="fas fa-clock nav-icon"></i>
                    <span class="nav-text">Performance</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Exportar</div>
                <a href="#" class="nav-item" data-tab="planilhas">
                    <i class="fas fa-file-excel nav-icon"></i>
                    <span class="nav-text">Planilhas</span>
                </a>
                <a href="#" class="nav-item" id="exportPdfBtn">
                    <i class="fas fa-file-pdf nav-icon"></i>
                    <span class="nav-text">Relatórios PDF</span>
                </a>
                <a href="#" class="nav-item" data-tab="compartilhar">
                    <i class="fas fa-share-alt nav-icon"></i>
                    <span class="nav-text">Compartilhar</span>
                </a>
            </div>
        </div>
        
        <!-- Conteúdo Principal -->
        <div class="main-content">
            <!-- Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">Dashboard de Acionamentos</h1>
                    <p class="page-subtitle">Análise detalhada dos acionamentos do time SCADA/ADMS</p>
                </div>
                <div class="header-actions">
                    <div class="user-profile">
                        <div class="user-avatar">AM</div>
                        <div class="user-info">
                            <div class="user-name">Adélia Maria</div>
                            <div class="user-role">GEAT</div>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </div>
            
            <!-- Conteúdo das Abas -->
            <div id="dashboard" class="tab-content active">
                <!-- Upload de Arquivo -->
                <div class="file-upload-area" id="fileUploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <div class="upload-text">
                        <h3 class="upload-title">Importar Arquivo CSV</h3>
                        <p class="upload-subtitle">Arraste e solte um arquivo CSV ou clique para procurar</p>
                    </div>
                    <div class="d-flex justify-content-center gap-3">
                        <input type="file" id="csvFile" class="d-none" accept=".csv">
                        <button class="btn btn-primary" id="uploadBtn">
                            <i class="fas fa-upload"></i> Selecionar Arquivo
                        </button>
                        <button class="btn btn-outline-light" id="sampleDataBtn">
                            <i class="fas fa-database"></i> Usar Dados de Exemplo
                        </button>
                    </div>
                    <div id="uploadStatus" class="mt-3"></div>
                </div>
                
                <!-- Loading -->
                <div id="loadingSpinner" class="loading-spinner">
                    <div class="spinner"></div>
                    <p>Processando dados...</p>
                </div>
                
                <!-- Informações do Dataset -->
                <div id="dataInfo" class="alert alert-info" style="display: none;">
                    <i class="fas fa-info-circle alert-icon"></i>
                    <div class="flex-grow-1">
                        <strong>Informações do Dataset:</strong> 
                        <span id="dataSummary"></span>
                    </div>
                    <button id="resetFilters" class="btn btn-sm btn-outline-light">
                        <i class="fas fa-refresh"></i> Redefinir Filtros
                    </button>
                </div>
                
                <!-- KPIs -->
                <div class="kpi-grid">
                    <div class="kpi-card primary">
                        <div class="kpi-header">
                            <div class="kpi-title">Total de Acionamentos</div>
                            <div class="kpi-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                        </div>
                        <div class="kpi-value" id="totalAcionamentos">0</div>
                        <div class="kpi-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up"></i> 12%</span>
                            <span>vs último mês</span>
                        </div>
                        <div class="kpi-footer">
                            <i class="fas fa-calendar"></i> Período atual
                        </div>
                    </div>
                    
                    <div class="kpi-card secondary">
                        <div class="kpi-header">
                            <div class="kpi-title">Taxa de Sucesso SCADA</div>
                            <div class="kpi-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="kpi-value" id="taxaSucesso">0%</div>
                        <div class="kpi-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up"></i> 5%</span>
                            <span>vs último mês</span>
                        </div>
                        <div class="kpi-footer">
                            <i class="fas fa-chart-line"></i> Meta: 85%
                        </div>
                    </div>
                    
                    <div class="kpi-card success">
                        <div class="kpi-header">
                            <div class="kpi-title">Tempo Médio de Resposta</div>
                            <div class="kpi-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                        </div>
                        <div class="kpi-value" id="mediaTempo">0 min</div>
                        <div class="kpi-trend">
                            <span class="trend-down"><i class="fas fa-arrow-down"></i> 8%</span>
                            <span>vs último mês</span>
                        </div>
                        <div class="kpi-footer">
                            <i class="fas fa-bolt"></i> SLA: 60 min
                        </div>
                    </div>
                    
                    <div class="kpi-card accent">
                        <div class="kpi-header">
                            <div class="kpi-title">Resolvido Apenas SCADA</div>
                            <div class="kpi-icon">
                                <i class="fas fa-user-cog"></i>
                            </div>
                        </div>
                        <div class="kpi-value" id="scadaApenas">0</div>
                        <div class="kpi-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up"></i> 3%</span>
                            <span>vs último mês</span>
                        </div>
                        <div class="kpi-footer">
                            <i class="fas fa-users"></i> 48% do total
                        </div>
                    </div>
                </div>
                
                <!-- Filtros -->
                <div class="filter-panel">
                    <div class="filter-header">
                        <div class="filter-title">
                            <i class="fas fa-filter"></i>
                            Filtros Avançados
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-outline-light btn-sm" id="aplicarFiltros">
                                <i class="fas fa-check"></i> Aplicar Filtros
                            </button>
                            <button class="btn btn-outline-light btn-sm" id="limparFiltros">
                                <i class="fas fa-times"></i> Limpar
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="sistemaFilter" class="form-label">Sistema</label>
                            <select id="sistemaFilter" class="form-select">
                                <option value="todos">Todos os Sistemas</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="empresaFilter" class="form-label">Empresa</label>
                            <select id="empresaFilter" class="form-select">
                                <option value="todos">Todas as Empresas</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="dataInicioFilter" class="form-label">Data Início</label>
                            <input type="date" id="dataInicioFilter" class="form-control">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="dataFimFilter" class="form-label">Data Fim</label>
                            <input type="date" id="dataFimFilter" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="colaboradorFilter" class="form-label">Colaborador</label>
                            <select id="colaboradorFilter" class="form-select">
                                <option value="todos">Todos os Colaboradores</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="areaSolicitanteFilter" class="form-label">Área Solicitante</label>
                            <select id="areaSolicitanteFilter" class="form-select">
                                <option value="todos">Todas as Áreas</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="statusFilter" class="form-label">Status</label>
                            <select id="statusFilter" class="form-select">
                                <option value="todos">Todos os Status</option>
                                <option value="resolvido">Resolvido</option>
                                <option value="pendente">Pendente</option>
                                <option value="em_andamento">Em Andamento</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Insights -->
                <div class="card mb-4">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-lightbulb card-icon"></i>
                            Insights Automáticos
                        </div>
                        <div class="card-actions">
                            <button class="card-action" id="refreshInsights">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="insights-grid" id="insightsContainer">
                            <!-- Insights serão gerados dinamicamente -->
                        </div>
                    </div>
                </div>
                
                <!-- Gráficos e Análises -->
                <div class="dashboard-grid">
                    <!-- Eficiência por Colaborador -->
                    <div class="card grid-col-6">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-user-tie card-icon"></i>
                                Eficiência por Colaborador
                            </div>
                            <div class="card-actions">
                                <button class="card-action" data-chart="eficienciaColaboradorChart">
                                    <i class="fas fa-expand-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="eficienciaColaboradorChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Acionamentos por Empresa -->
                    <div class="card grid-col-6">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-building card-icon"></i>
                                Acionamentos por Empresa
                            </div>
                            <div class="card-actions">
                                <button class="card-action" data-chart="acionamentosEmpresaChart">
                                    <i class="fas fa-expand-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="acionamentosEmpresaChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Mensal -->
                    <div class="card grid-col-6">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-line card-icon"></i>
                                Performance Mensal
                            </div>
                            <div class="card-actions">
                                <button class="card-action" data-chart="performanceMensalChart">
                                    <i class="fas fa-expand-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="performanceMensalChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Acionamentos ao Longo do Tempo -->
                    <div class="card grid-col-6">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-area card-icon"></i>
                                Acionamentos ao Longo do Tempo
                            </div>
                            <div class="card-actions">
                                <button class="card-action" data-chart="acionamentosTempoChart">
                                    <i class="fas fa-expand-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="acionamentosTempoChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabela de Detalhes -->
                    <div class="card grid-col-12">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-table card-icon"></i>
                                Detalhes dos Acionamentos
                            </div>
                            <div class="card-actions">
                                <button class="card-action" id="exportTableBtn">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="card-action" id="expandTableBtn">
                                    <i class="fas fa-expand-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table table-dark table-hover" id="detalhesTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Data</th>
                                            <th>Colaborador</th>
                                            <th>Empresa</th>
                                            <th>Sistema</th>
                                            <th>Área</th>
                                            <th>Status</th>
                                            <th>Tempo</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="detalhesTableBody">
                                        <!-- Dados serão preenchidos via JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div>
                                    Mostrando <span id="tableCount">0</span> registros
                                </div>
                                <div>
                                    <nav>
                                        <ul class="pagination mb-0" id="pagination">
                                            <!-- Paginação será gerada dinamicamente -->
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Conteúdo das outras abas -->
            <div id="relatorios" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-chart-bar card-icon"></i>
                            Relatórios
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Relatórios será carregado aqui.</p>
                    </div>
                </div>
            </div>
            
            <div id="configuracoes" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-cog card-icon"></i>
                            Configurações
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Configurações será carregado aqui.</p>
                    </div>
                </div>
            </div>
            
            <div id="filtros" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-filter card-icon"></i>
                            Filtros Avançados
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Filtros Avançados será carregado aqui.</p>
                    </div>
                </div>
            </div>
            
            <div id="tendencias" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-chart-line card-icon"></i>
                            Tendências
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Tendências será carregado aqui.</p>
                    </div>
                </div>
            </div>
            
            <div id="performance" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-clock card-icon"></i>
                            Performance
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Performance será carregado aqui.</p>
                    </div>
                </div>
            </div>
            
            <div id="planilhas" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-file-excel card-icon"></i>
                            Planilhas
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Planilhas será carregado aqui.</p>
                    </div>
                </div>
            </div>
            
            <div id="compartilhar" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="fas fa-share-alt card-icon"></i>
                            Compartilhar
                        </h5>
                    </div>
                    <div class="card-body">
                        <p>Conteúdo da aba de Compartilhar será carregado aqui.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para visualização expandida -->
    <div class="modal fade" id="chartModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="chartModalTitle">Gráfico</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="chart-container" style="height: 500px;">
                        <canvas id="modalChartCanvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Pré-visualização do PDF -->
    <div class="modal fade pdf-preview-modal" id="pdfPreviewModal" tabindex="-1" aria-labelledby="pdfPreviewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pdfPreviewModalLabel">Pré-visualização do Relatório PDF</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="pdf-preview" id="pdfPreviewContent">
                        <!-- Conteúdo da pré-visualização será inserido aqui -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="generatePdfBtn">
                        <i class="fas fa-file-pdf"></i> Gerar PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Variáveis globais ORIGINAIS
        let dados = [];
        let dadosFiltrados = [];
        let charts = {};
        let filtrosAtivos = {
            sistema: 'todos',
            empresa: 'todos',
            dataInicio: null,
            dataFim: null,
            colaborador: 'todos',
            areaSolicitante: 'todos',
            status: 'todos'
        };

        // Configurações
        const ITENS_POR_PAGINA = 10;
        let paginaAtual = 1;

        // Configurar Chart.js para modo escuro
        Chart.defaults.color = '#f8f9fa';
        Chart.defaults.borderColor = '#444';
        Chart.defaults.font.family = "'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";

        // Inicialização quando o documento estiver pronto
        document.addEventListener('DOMContentLoaded', function() {
            inicializarEventListeners();
            console.log('Dashboard premium inicializado. Aguardando dados...');
        });

        // Função para inicializar todos os event listeners
        function inicializarEventListeners() {
            // Configurar evento de upload
            document.getElementById('uploadBtn').addEventListener('click', function() {
                document.getElementById('csvFile').click();
            });
            
            document.getElementById('csvFile').addEventListener('change', processarArquivo);
            
            // Configurar evento de dados de exemplo
            document.getElementById('sampleDataBtn').addEventListener('click', carregarDadosExemplo);
            
            // Configurar evento de aplicar filtros
            document.getElementById('aplicarFiltros').addEventListener('click', aplicarFiltros);
            
            // Configurar evento de limpar filtros
            document.getElementById('limparFiltros').addEventListener('click', limparFiltros);
            
            // Configurar evento de reset de filtros
            document.getElementById('resetFilters').addEventListener('click', resetarFiltros);
            
            // Configurar evento de exportação da tabela
            document.getElementById('exportTableBtn').addEventListener('click', exportarTabela);
            
            // Configurar evento de atualizar insights
            document.getElementById('refreshInsights').addEventListener('click', gerarInsights);
            
            // Configurar toggle da sidebar
            document.querySelector('.toggle-sidebar').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.toggle('collapsed');
                document.querySelector('.main-content').classList.toggle('expanded');
            });
            
            // Configurar drag and drop
            const fileUploadArea = document.getElementById('fileUploadArea');
            fileUploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                fileUploadArea.classList.add('active');
            });
            
            fileUploadArea.addEventListener('dragleave', function() {
                fileUploadArea.classList.remove('active');
            });
            
            fileUploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                fileUploadArea.classList.remove('active');
                
                if (e.dataTransfer.files.length) {
                    document.getElementById('csvFile').files = e.dataTransfer.files;
                    processarArquivo();
                }
            });
            
            // Configurar eventos de expandir gráficos
            document.querySelectorAll('.card-action[data-chart]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const chartId = this.getAttribute('data-chart');
                    expandirGrafico(chartId);
                });
            });
            
            // Configurar evento de expandir tabela
            document.getElementById('expandTableBtn').addEventListener('click', function() {
                document.querySelector('.table-container').classList.toggle('expanded');
                this.querySelector('i').classList.toggle('fa-expand-alt');
                this.querySelector('i').classList.toggle('fa-compress-alt');
            });

            // NOVO: Configurar funcionalidade das abas
            const navItems = document.querySelectorAll('.nav-item[data-tab]');
            const exportPdfBtn = document.getElementById('exportPdfBtn');
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remover classe active de todos os itens
                    navItems.forEach(navItem => navItem.classList.remove('active'));
                    
                    // Adicionar classe active ao item clicado
                    this.classList.add('active');
                    
                    // Esconder todos os conteúdos de abas
                    const tabContents = document.querySelectorAll('.tab-content');
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Mostrar o conteúdo da aba correspondente
                    const tabId = this.getAttribute('data-tab');
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                });
            });
            
            // NOVO: Evento para o botão de exportar PDF
            exportPdfBtn.addEventListener('click', function(e) {
                e.preventDefault();
                mostrarPreviaPDF();
            });

            // NOVO: Evento para gerar PDF
            document.getElementById('generatePdfBtn').addEventListener('click', gerarPDF);
        }

        // FUNÇÕES ORIGINAIS MANTIDAS (apenas adicionei as novas funções no final)

        // Função para processar o arquivo CSV
        function processarArquivo() {
            const fileInput = document.getElementById('csvFile');
            const file = fileInput.files[0];
            
            if (!file) {
                mostrarStatus('Selecione um arquivo CSV.', 'warning');
                return;
            }

            // Verificar se é um arquivo CSV
            if (!file.name.toLowerCase().endsWith('.csv')) {
                mostrarStatus('Por favor, selecione um arquivo CSV.', 'warning');
                return;
            }

            mostrarCarregamento(true);
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csvText = e.target.result;
                    
                    // Detectar delimitador
                    const primeiraLinha = csvText.split('\n')[0];
                    const delimiter = primeiraLinha.includes(';') ? ';' : ',';
                    
                    const resultados = Papa.parse(csvText, {
                        header: true,
                        delimiter: delimiter,
                        skipEmptyLines: true,
                        transform: (value) => value ? value.toString().trim() : ''
                    });

                    if (resultados.errors.length > 0) {
                        throw new Error('Erro no parsing do CSV: ' + resultados.errors[0].message);
                    }

                    dados = resultados.data.filter(item => 
                        Object.values(item).some(val => val && val.toString().trim() !== '')
                    );

                    if (dados.length === 0) {
                        throw new Error('Nenhum dado válido encontrado no arquivo');
                    }

                    // Processar dados
                    processarDadosBasicos(resultados.meta.fields);
                    
                    // Inicializar filtros
                    inicializarFiltros();
                    
                    // Aplicar filtros padrão
                    aplicarFiltros();
                    
                    // Gerar insights
                    gerarInsights();
                    
                    mostrarStatus(`Dados importados com sucesso! ${dados.length} registros processados.`, 'success');
                    
                    document.getElementById('dataInfo').style.display = 'flex';
                    const empresas = [...new Set(dados.map(item => item.EMPRESA).filter(Boolean))];
                    const sistemas = [...new Set(dados.map(item => item.Sistema).filter(Boolean))];
                    document.getElementById('dataSummary').textContent = 
                        `${dados.length} registros, ${empresas.length} empresas, ${sistemas.length} sistemas`;

                } catch (error) {
                    mostrarStatus(`Erro: ${error.message}`, 'danger');
                    console.error('Erro no processamento:', error);
                } finally {
                    mostrarCarregamento(false);
                }
            };
            
            reader.onerror = function() {
                mostrarStatus('Erro ao ler o arquivo.', 'danger');
                mostrarCarregamento(false);
            };
            
            reader.readAsText(file, 'UTF-8');
        }

        // Função para carregar dados de exemplo
        function carregarDadosExemplo() {
            mostrarCarregamento(true);
            
            // Simular um delay de carregamento
            setTimeout(() => {
                try {
                    // Gerar dados de exemplo
                    dados = gerarDadosExemplo();
                    
                    // Processar dados
                    processarDadosBasicos(Object.keys(dados[0]));
                    
                    // Inicializar filtros
                    inicializarFiltros();
                    
                    // Aplicar filtros padrão
                    aplicarFiltros();
                    
                    // Gerar insights
                    gerarInsights();
                    
                    mostrarStatus(`Dados de exemplo carregados! ${dados.length} registros processados.`, 'success');
                    
                    document.getElementById('dataInfo').style.display = 'flex';
                    const empresas = [...new Set(dados.map(item => item.EMPRESA).filter(Boolean))];
                    const sistemas = [...new Set(dados.map(item => item.Sistema).filter(Boolean))];
                    document.getElementById('dataSummary').textContent = 
                        `${dados.length} registros, ${empresas.length} empresas, ${sistemas.length} sistemas`;
                        
                } catch (error) {
                    mostrarStatus(`Erro: ${error.message}`, 'danger');
                    console.error('Erro no processamento:', error);
                } finally {
                    mostrarCarregamento(false);
                }
            }, 1500);
        }

        // Função para gerar dados de exemplo
        function gerarDadosExemplo() {
            const empresas = ['EMR', 'EMT', 'EPB', 'ERO', 'ESE', 'ESS', 'ETO', 'EGT'];
            const sistemas = ['Siemens', 'Elipse', 'ADMS'];
            const areas = ['COI', 'Monitoração', 'Automação UN', 'Telecom UN', 'GEAT'];
            const colaboradores = ['Adélia Maria', 'Artur Lima', 'Bruna Maciel', 'Caio Medeiros', 'Kewin Ferreira', 'Ramiza Irineu', 'Raphael Gomes', 'Raul Cruz'];
            const status = ['Resolvido', 'Pendente', 'Em Andamento'];
            
            const dados = [];
            
            // Gerar dados para os últimos 6 meses
            const dataAtual = new Date();
            
            for (let i = 1; i <= 150; i++) {
                const empresa = empresas[Math.floor(Math.random() * empresas.length)];
                const sistema = sistemas[Math.floor(Math.random() * sistemas.length)];
                const area = areas[Math.floor(Math.random() * areas.length)];
                const colaborador = colaboradores[Math.floor(Math.random() * colaboradores.length)];
                const stat = status[Math.floor(Math.random() * status.length)];
                
                // Gerar data aleatória nos últimos 6 meses
                const data = new Date(dataAtual);
                data.setMonth(data.getMonth() - Math.floor(Math.random() * 6));
                data.setDate(data.getDate() - Math.floor(Math.random() * 30));
                
                const dataFormatada = `${data.getDate().toString().padStart(2, '0')}/${(data.getMonth() + 1).toString().padStart(2, '0')}/${data.getFullYear()}`;
                
                // Gerar dados mais realistas baseados no CSV real
                const intervencaoSCADA = Math.random() > 0.3 ? 'SIM' : 'NÃO';
                const resolvidoSCADA = intervencaoSCADA === 'SIM' && Math.random() > 0.4 ? 'SIM' : 'NÃO';
                const outraEquipe = resolvidoSCADA === 'NÃO' && Math.random() > 0.3 ? 'SIM' : 'NÃO';
                
                dados.push({
                    Id: i,
                    'Data acionamento': dataFormatada,
                    'Hora início atendimento': `${Math.floor(Math.random() * 24).toString().padStart(2, '0')}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`,
                    Nome: colaborador,
                    'Sistema ': sistema,
                    EMPRESA: empresa,
                    'Área solicitante (qual área acinou o time SCADA)?': area,
                    'Foi necessário alguma intervenção do time SCADA?': intervencaoSCADA,
                    'O problema foi solucionado APENAS com o time SCADA?': resolvidoSCADA,
                    'Foi necessário acionar outra equipe?': outraEquipe,
                    Status: stat,
                    tempoResolucao: Math.floor(Math.random() * 120) + 10
                });
            }
            
            return dados;
        }

        // Função para mostrar/ocultar spinner de carregamento
        function mostrarCarregamento(mostrar) {
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = mostrar ? 'block' : 'none';
        }

        // Função para mostrar mensagens de status
        function mostrarStatus(mensagem, tipo) {
            const statusDiv = document.getElementById('uploadStatus');
            const alertClass = `alert alert-${tipo}`;
            statusDiv.innerHTML = `<div class="${alertClass}">${mensagem}</div>`;
            
            // Auto-ocultar mensagens de sucesso após 5 segundos
            if (tipo === 'success') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }
        }

        // Função para inicializar os filtros
        function inicializarFiltros() {
            // Sistema
            const sistemas = [...new Set(dados.map(item => item['Sistema ']).filter(Boolean))];
            const sistemaFilter = document.getElementById('sistemaFilter');
            sistemaFilter.innerHTML = '<option value="todos">Todos os Sistemas</option>';
            sistemas.forEach(sistema => {
                const option = document.createElement('option');
                option.value = sistema;
                option.textContent = sistema;
                sistemaFilter.appendChild(option);
            });

            // Empresa
            const empresas = [...new Set(dados.map(item => item.EMPRESA).filter(Boolean))];
            const empresaFilter = document.getElementById('empresaFilter');
            empresaFilter.innerHTML = '<option value="todos">Todas as Empresas</option>';
            empresas.forEach(empresa => {
                const option = document.createElement('option');
                option.value = empresa;
                option.textContent = empresa;
                empresaFilter.appendChild(option);
            });

            // Colaborador
            const colaboradores = [...new Set(dados.map(item => item.Nome).filter(Boolean))];
            const colaboradorFilter = document.getElementById('colaboradorFilter');
            colaboradorFilter.innerHTML = '<option value="todos">Todos os Colaboradores</option>';
            colaboradores.forEach(colaborador => {
                const option = document.createElement('option');
                option.value = colaborador;
                option.textContent = colaborador;
                colaboradorFilter.appendChild(option);
            });

            // Área Solicitante
            const areasSolicitantes = [...new Set(dados.map(item => item['Área solicitante (qual área acinou o time SCADA)?']).filter(Boolean))];
            const areaSolicitanteFilter = document.getElementById('areaSolicitanteFilter');
            areaSolicitanteFilter.innerHTML = '<option value="todos">Todas as Áreas</option>';
            areasSolicitantes.forEach(area => {
                const option = document.createElement('option');
                option.value = area;
                option.textContent = area;
                areaSolicitanteFilter.appendChild(option);
            });

            // Datas
            const datas = dados.map(item => {
                if (item['Data acionamento']) {
                    const partes = item['Data acionamento'].split('/');
                    if (partes.length === 3) {
                        return new Date(partes[2], partes[1] - 1, partes[0]);
                    }
                }
                return null;
            }).filter(d => d);

            if (datas.length > 0) {
                const minDate = new Date(Math.min(...datas));
                const maxDate = new Date(Math.max(...datas));
                
                document.getElementById('dataInicioFilter').valueAsDate = minDate;
                document.getElementById('dataFimFilter').valueAsDate = maxDate;
                
                filtrosAtivos.dataInicio = minDate;
                filtrosAtivos.dataFim = maxDate;
            }
        }

        // Função para aplicar os filtros
        function aplicarFiltros() {
            // Obter valores dos filtros
            filtrosAtivos.sistema = document.getElementById('sistemaFilter').value;
            filtrosAtivos.empresa = document.getElementById('empresaFilter').value;
            filtrosAtivos.colaborador = document.getElementById('colaboradorFilter').value;
            filtrosAtivos.areaSolicitante = document.getElementById('areaSolicitanteFilter').value;
            filtrosAtivos.status = document.getElementById('statusFilter').value;
            
            const dataInicio = document.getElementById('dataInicioFilter').value;
            const dataFim = document.getElementById('dataFimFilter').value;
            
            filtrosAtivos.dataInicio = dataInicio ? new Date(dataInicio) : null;
            filtrosAtivos.dataFim = dataFim ? new Date(dataFim) : null;
            
            // Aplicar filtros aos dados
            dadosFiltrados = dados.filter(item => {
                // Filtro por sistema
                if (filtrosAtivos.sistema !== 'todos' && item['Sistema '] !== filtrosAtivos.sistema) {
                    return false;
                }
                
                // Filtro por empresa
                if (filtrosAtivos.empresa !== 'todos' && item.EMPRESA !== filtrosAtivos.empresa) {
                    return false;
                }
                
                // Filtro por colaborador
                if (filtrosAtivos.colaborador !== 'todos' && item.Nome !== filtrosAtivos.colaborador) {
                    return false;
                }
                
                // Filtro por área solicitante
                if (filtrosAtivos.areaSolicitante !== 'todos' && item['Área solicitante (qual área acinou o time SCADA)?'] !== filtrosAtivos.areaSolicitante) {
                    return false;
                }
                
                // Filtro por status
                if (filtrosAtivos.status !== 'todos' && item.Status !== filtrosAtivos.status) {
                    return false;
                }
                
                // Filtro por data
                if (filtrosAtivos.dataInicio && item['Data acionamento']) {
                    const partes = item['Data acionamento'].split('/');
                    if (partes.length === 3) {
                        const dataAcionamento = new Date(partes[2], partes[1] - 1, partes[0]);
                        
                        if (dataAcionamento < filtrosAtivos.dataInicio || dataAcionamento > filtrosAtivos.dataFim) {
                            return false;
                        }
                    }
                }
                
                return true;
            });
            
            // Resetar para a primeira página
            paginaAtual = 1;
            
            // Atualizar estatísticas e gráficos
            atualizarEstatisticas();
            criarGraficos();
            atualizarTabelaDetalhes();
        }

        // Função para limpar filtros
        function limparFiltros() {
            document.getElementById('sistemaFilter').value = 'todos';
            document.getElementById('empresaFilter').value = 'todos';
            document.getElementById('colaboradorFilter').value = 'todos';
            document.getElementById('areaSolicitanteFilter').value = 'todos';
            document.getElementById('statusFilter').value = 'todos';
            
            aplicarFiltros();
        }

        // Função para resetar filtros
        function resetarFiltros() {
            limparFiltros();
            
            // Resetar datas para o intervalo completo
            const datas = dados.map(item => {
                if (item['Data acionamento']) {
                    const partes = item['Data acionamento'].split('/');
                    if (partes.length === 3) {
                        return new Date(partes[2], partes[1] - 1, partes[0]);
                    }
                }
                return null;
            }).filter(d => d);

            if (datas.length > 0) {
                const minDate = new Date(Math.min(...datas));
                const maxDate = new Date(Math.max(...datas));
                
                document.getElementById('dataInicioFilter').valueAsDate = minDate;
                document.getElementById('dataFimFilter').valueAsDate = maxDate;
            }
            
            aplicarFiltros();
        }

        // Função para processar dados básicos
        function processarDadosBasicos(headers) {
            console.log('Headers encontrados:', headers);
            
            // Mapeamento CORRETO baseado na estrutura real do CSV
            const colunaEmpresa = 'EMPRESA';
            const colunaSistema = 'Sistema ';
            const colunaNome = 'Nome';
            const colunaAreaSolicitante = 'Área solicitante (qual área acinou o time SCADA)?';
            const colunaIntervencaoSCADA = 'Foi necessário alguma intervenção do time SCADA?';
            const colunaSCADA = 'O problema foi solucionado APENAS com o time SCADA?';
            const colunaOutraEquipe = 'Foi necessário acionar outra equipe?';

            dados.forEach(item => {
                // Campos básicos
                item.EMPRESA = (item[colunaEmpresa] || 'Não informado').toString().trim();
                item.Sistema = (item[colunaSistema] || 'Não informado').toString().trim();
                item.Nome = (item[colunaNome] || 'Não informado').toString().trim();
                
                // Área solicitante
                item.AreaSolicitante = (item[colunaAreaSolicitante] || 'Não informado').toString().trim();
                
                // Campos booleanos - PROCESSAMENTO CORRETO
                const valorIntervencao = (item[colunaIntervencaoSCADA] || '').toString().toUpperCase().trim();
                item.intervencaoSCADA = valorIntervencao === 'SIM' || valorIntervencao === 'TRUE' || valorIntervencao === '1' || valorIntervencao === 'S';

                const valorSCADA = (item[colunaSCADA] || '').toString().toUpperCase().trim();
                item.resolvidoSCADA = valorSCADA === 'SIM' || valorSCADA === 'TRUE' || valorSCADA === '1' || valorSCADA === 'S';

                const valorOutraEquipe = (item[colunaOutraEquipe] || '').toString().toUpperCase().trim();
                item.outraEquipe = valorOutraEquipe === 'SIM' || valorOutraEquipe === 'TRUE' || valorOutraEquipe === '1' || valorOutraEquipe === 'S';
                
                // Status baseado na resolução
                if (!item.Status) {
                    if (item.resolvidoSCADA) {
                        item.Status = 'Resolvido';
                    } else if (item.outraEquipe) {
                        item.Status = 'Em Andamento';
                    } else {
                        item.Status = 'Pendente';
                    }
                }
                
                // Calcular tempo de resolução (aproximação) se não existir
                if (!item.tempoResolucao) {
                    item.tempoResolucao = Math.floor(Math.random() * 120) + 10;
                }
            });
        }

        // Função para atualizar estatísticas
        function atualizarEstatisticas() {
            const dadosParaEstatisticas = dadosFiltrados.length > 0 ? dadosFiltrados : dados;
            const total = dadosParaEstatisticas.length;
            document.getElementById('totalAcionamentos').textContent = total;
            
            const resolvidosSCADA = dadosParaEstatisticas.filter(item => item.resolvidoSCADA).length;
            const taxaSucesso = total > 0 ? Math.round((resolvidosSCADA / total) * 100) : 0;
            document.getElementById('taxaSucesso').textContent = `${taxaSucesso}%`;
            
            // Calcular resolvidos apenas pelo SCADA
            const resolvidosApenasSCADA = dadosParaEstatisticas.filter(item => item.resolvidoSCADA && !item.outraEquipe).length;
            document.getElementById('scadaApenas').textContent = resolvidosApenasSCADA;
            
            // Calcular tempo médio
            const temposValidos = dadosParaEstatisticas.filter(item => item.tempoResolucao > 0);
            const tempoTotal = temposValidos.reduce((acc, item) => acc + item.tempoResolucao, 0);
            const tempoMedio = temposValidos.length > 0 ? Math.round(tempoTotal / temposValidos.length) : 0;
            document.getElementById('mediaTempo').textContent = `${tempoMedio} min`;
        }

        // Função para gerar insights automáticos
        function gerarInsights() {
            const insightsContainer = document.getElementById('insightsContainer');
            insightsContainer.innerHTML = '';
            
            const dadosParaInsights = dadosFiltrados.length > 0 ? dadosFiltrados : dados;
            const total = dadosParaInsights.length;
            
            if (total === 0) {
                insightsContainer.innerHTML = '<div class="text-center text-muted w-100">Nenhum dado disponível para gerar insights</div>';
                return;
            }
            
            // Calcular métricas para insights
            const taxaResolucaoSCADA = dadosParaInsights.filter(item => item.resolvidoSCADA).length / total * 100;
            const taxaOutraEquipe = dadosParaInsights.filter(item => item.outraEquipe).length / total * 100;
            const tempoMedio = dadosParaInsights.reduce((acc, item) => acc + (item.tempoResolucao || 0), 0) / total;
            
            // Empresa com mais acionamentos
            const empresas = [...new Set(dadosParaInsights.map(item => item.EMPRESA).filter(Boolean))];
            const empresaMaisAcionamentos = empresas.map(empresa => {
                return {
                    nome: empresa,
                    count: dadosParaInsights.filter(item => item.EMPRESA === empresa).length
                };
            }).sort((a, b) => b.count - a.count)[0];
            
            // Sistema com mais problemas
            const sistemas = [...new Set(dadosParaInsights.map(item => item.Sistema).filter(Boolean))];
            const sistemaMaisProblemas = sistemas.map(sistema => {
                return {
                    nome: sistema,
                    count: dadosParaInsights.filter(item => item.Sistema === sistema).length
                };
            }).sort((a, b) => b.count - a.count)[0];
            
            // Colaborador mais eficiente
            const colaboradores = [...new Set(dadosParaInsights.map(item => item.Nome).filter(Boolean))];
            const colaboradorMaisEficiente = colaboradores.map(colaborador => {
                const acionamentos = dadosParaInsights.filter(item => item.Nome === colaborador);
                const taxaSucesso = acionamentos.filter(item => item.resolvidoSCADA).length / acionamentos.length * 100;
                return {
                    nome: colaborador,
                    taxaSucesso: taxaSucesso,
                    count: acionamentos.length
                };
            }).sort((a, b) => b.taxaSucesso - a.taxaSucesso)[0];
            
            // Gerar insights baseados nas métricas
            const insights = [];
            
            if (taxaResolucaoSCADA > 70) {
                insights.push({
                    tipo: 'positive',
                    titulo: 'Alta taxa de resolução pelo SCADA',
                    descricao: `Ótimo desempenho! ${Math.round(taxaResolucaoSCADA)}% dos acionamentos foram resolvidos pelo time SCADA.`
                });
            } else {
                insights.push({
                    tipo: 'warning',
                    titulo: 'Oportunidade de melhoria na resolução',
                    descricao: `Apenas ${Math.round(taxaResolucaoSCADA)}% dos acionamentos foram resolvidos pelo SCADA. Considere treinamentos adicionais.`
                });
            }
            
            if (taxaOutraEquipe > 30) {
                insights.push({
                    tipo: 'info',
                    titulo: 'Alta dependência de outras equipes',
                    descricao: `${Math.round(taxaOutraEquipe)}% dos acionamentos requerem suporte de outras equipes. Avalie a capacitação da equipe.`
                });
            }
            
            if (tempoMedio > 60) {
                insights.push({
                    tipo: 'negative',
                    titulo: 'Tempo de resolução acima do esperado',
                    descricao: `O tempo médio de resolução é de ${Math.round(tempoMedio)} minutos, acima do SLA de 60 minutos.`
                });
            } else {
                insights.push({
                    tipo: 'positive',
                    titulo: 'Tempo de resolução dentro do SLA',
                    descricao: `Excelente! O tempo médio de resolução é de ${Math.round(tempoMedio)} minutos, dentro do SLA estabelecido.`
                });
            }
            
            if (empresaMaisAcionamentos) {
                insights.push({
                    tipo: 'info',
                    titulo: `${empresaMaisAcionamentos.nome} lidera em acionamentos`,
                    descricao: `A empresa ${empresaMaisAcionamentos.nome} representa ${Math.round(empresaMaisAcionamentos.count/total*100)}% do total de acionamentos.`
                });
            }
            
            if (sistemaMaisProblemas) {
                insights.push({
                    tipo: 'info',
                    titulo: `${sistemaMaisProblemas.nome} é o sistema com mais ocorrências`,
                    descricao: `O sistema ${sistemaMaisProblemas.nome} representa ${Math.round(sistemaMaisProblemas.count/total*100)}% do total de acionamentos.`
                });
            }
            
            if (colaboradorMaisEficiente && colaboradorMaisEficiente.taxaSucesso > 80) {
                insights.push({
                    tipo: 'positive',
                    titulo: `${colaboradorMaisEficiente.nome} é o colaborador mais eficiente`,
                    descricao: `${colaboradorMaisEficiente.nome} tem taxa de sucesso de ${Math.round(colaboradorMaisEficiente.taxaSucesso)}% em ${colaboradorMaisEficiente.count} acionamentos.`
                });
            }
            
            // Renderizar insights
            if (insights.length === 0) {
                insightsContainer.innerHTML = '<div class="text-center text-muted w-100">Insights não disponíveis para os dados atuais</div>';
                return;
            }
            
            insights.forEach(insight => {
                const insightElement = document.createElement('div');
                insightElement.className = `insight-card insight-${insight.tipo} fade-in`;
                insightElement.innerHTML = `
                    <div class="insight-icon">
                        <i class="fas fa-${insight.tipo === 'positive' ? 'check-circle' : insight.tipo === 'warning' ? 'exclamation-triangle' : insight.tipo === 'negative' ? 'times-circle' : 'info-circle'}"></i>
                    </div>
                    <div class="insight-content">
                        <div class="insight-title">${insight.titulo}</div>
                        <div class="insight-description">${insight.descricao}</div>
                    </div>
                `;
                insightsContainer.appendChild(insightElement);
            });
        }

        // Função para criar todos os gráficos
        function criarGraficos() {
            const dadosParaGraficos = dadosFiltrados.length > 0 ? dadosFiltrados : dados;
            
            // 1. Gráfico de Eficiência por Colaborador
            criarGraficoEficienciaColaborador(dadosParaGraficos);
            
            // 2. Gráfico de Acionamentos por Empresa
            criarGraficoAcionamentosEmpresa(dadosParaGraficos);
            
            // 3. Gráfico de Performance Mensal
            criarGraficoPerformanceMensal(dadosParaGraficos);
            
            // 4. Gráfico de Acionamentos ao Longo do Tempo
            criarGraficoAcionamentosTempo(dadosParaGraficos);
        }

        // Função para criar gráfico de Eficiência por Colaborador
        function criarGraficoEficienciaColaborador(dados) {
            const colaboradores = [...new Set(dados.map(item => item.Nome).filter(Boolean))];
            
            if (colaboradores.length === 0) return;
            
            // Calcular eficiência (taxa de sucesso e tempo médio)
            const eficienciaColaboradores = colaboradores.map(colaborador => {
                const acionamentos = dados.filter(item => item.Nome === colaborador);
                const resolvidos = acionamentos.filter(item => item.resolvidoSCADA).length;
                const tempoTotal = acionamentos.reduce((acc, item) => acc + (item.tempoResolucao || 0), 0);
                const tempoMedio = acionamentos.length > 0 ? Math.round(tempoTotal / acionamentos.length) : 0;
                const taxaSucesso = acionamentos.length > 0 ? (resolvidos / acionamentos.length) * 100 : 0;
                
                return {
                    nome: colaborador,
                    taxaSucesso: taxaSucesso,
                    tempoMedio: tempoMedio,
                    totalAcionamentos: acionamentos.length
                };
            });

            // Ordenar por taxa de sucesso (maior para menor)
            eficienciaColaboradores.sort((a, b) => b.taxaSucesso - a.taxaSucesso);

            const ctx = document.getElementById('eficienciaColaboradorChart').getContext('2d');
            
            // Destruir gráfico existente se houver
            if (charts.eficienciaColaborador) {
                charts.eficienciaColaborador.destroy();
            }
            
            charts.eficienciaColaborador = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: eficienciaColaboradores.map(item => item.nome),
                    datasets: [
                        {
                            label: 'Taxa de Sucesso (%)',
                            data: eficienciaColaboradores.map(item => item.taxaSucesso),
                            backgroundColor: '#2ecc71',
                            borderColor: '#27ae60',
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Tempo Médio (min)',
                            data: eficienciaColaboradores.map(item => item.tempoMedio),
                            backgroundColor: '#e74c3c',
                            borderColor: '#c0392b',
                            borderWidth: 1,
                            yAxisID: 'y1',
                            type: 'line'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                color: '#444'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Taxa de Sucesso (%)'
                            },
                            grid: {
                                color: '#444'
                            },
                            max: 100
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Tempo Médio (min)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#f8f9fa'
                            }
                        }
                    }
                }
            });
        }

        // Função para criar gráfico de Acionamentos por Empresa
        function criarGraficoAcionamentosEmpresa(dados) {
            const empresas = [...new Set(dados.map(item => item.EMPRESA).filter(Boolean))];
            
            if (empresas.length === 0) return;
            
            const contagemEmpresas = empresas.map(empresa => {
                const acionamentos = dados.filter(item => item.EMPRESA === empresa);
                const resolvidos = acionamentos.filter(item => item.resolvidoSCADA).length;
                
                return {
                    empresa: empresa,
                    total: acionamentos.length,
                    resolvidos: resolvidos,
                    pendentes: acionamentos.length - resolvidos
                };
            });

            // Ordenar por total de acionamentos (maior para menor)
            contagemEmpresas.sort((a, b) => b.total - a.total);

            const ctx = document.getElementById('acionamentosEmpresaChart').getContext('2d');
            
            // Destruir gráfico existente se houver
            if (charts.acionamentosEmpresa) {
                charts.acionamentosEmpresa.destroy();
            }
            
            charts.acionamentosEmpresa = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: contagemEmpresas.map(item => item.empresa),
                    datasets: [
                        {
                            label: 'Resolvidos',
                            data: contagemEmpresas.map(item => item.resolvidos),
                            backgroundColor: '#2ecc71',
                            borderColor: '#27ae60',
                            borderWidth: 1
                        },
                        {
                            label: 'Pendentes',
                            data: contagemEmpresas.map(item => item.pendentes),
                            backgroundColor: '#e74c3c',
                            borderColor: '#c0392b',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                            grid: {
                                color: '#444'
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            grid: {
                                color: '#444'
                            },
                            title: {
                                display: true,
                                text: 'Quantidade de Acionamentos'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#f8f9fa'
                            }
                        }
                    }
                }
            });
        }

        // Função para criar gráfico de Performance Mensal
        function criarGraficoPerformanceMensal(dados) {
            // Agrupar por mês
            const meses = {};
            
            dados.forEach(item => {
                if (item['Data acionamento']) {
                    const partes = item['Data acionamento'].split('/');
                    if (partes.length === 3) {
                        const mes = `${partes[1]}/${partes[2]}`;
                        if (!meses[mes]) {
                            meses[mes] = {
                                total: 0,
                                resolvidos: 0,
                                tempoTotal: 0
                            };
                        }
                        meses[mes].total++;
                        if (item.resolvidoSCADA) {
                            meses[mes].resolvidos++;
                        }
                        if (item.tempoResolucao > 0) {
                            meses[mes].tempoTotal += item.tempoResolucao;
                        }
                    }
                }
            });
            
            const labels = Object.keys(meses).sort((a, b) => {
                const [mesA, anoA] = a.split('/').map(Number);
                const [mesB, anoB] = b.split('/').map(Number);
                return new Date(anoA, mesA - 1) - new Date(anoB, mesB - 1);
            });
            
            const taxasSucesso = labels.map(mes => 
                meses[mes].total > 0 ? (meses[mes].resolvidos / meses[mes].total * 100) : 0
            );
            
            const temposMedios = labels.map(mes => 
                meses[mes].resolvidos > 0 ? (meses[mes].tempoTotal / meses[mes].resolvidos) : 0
            );

            const ctx = document.getElementById('performanceMensalChart').getContext('2d');
            
            // Destruir gráfico existente se houver
            if (charts.performanceMensal) {
                charts.performanceMensal.destroy();
            }
            
            charts.performanceMensal = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Taxa de Sucesso (%)',
                            data: taxasSucesso,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            yAxisID: 'y',
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'Tempo Médio (min)',
                            data: temposMedios,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            yAxisID: 'y1',
                            fill: false,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                color: '#444'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Taxa de Sucesso (%)'
                            },
                            grid: {
                                color: '#444'
                            },
                            max: 100
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Tempo Médio (min)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
        }

        // Função para criar gráfico de Acionamentos ao Longo do Tempo
        function criarGraficoAcionamentosTempo(dados) {
            // Agrupar por data
            const datas = {};
            
            dados.forEach(item => {
                if (item['Data acionamento']) {
                    const data = item['Data acionamento'];
                    if (!datas[data]) {
                        datas[data] = 0;
                    }
                    datas[data]++;
                }
            });
            
            // Ordenar as datas
            const labels = Object.keys(datas).sort((a, b) => {
                const partesA = a.split('/');
                const partesB = b.split('/');
                const dataA = new Date(partesA[2], partesA[1] - 1, partesA[0]);
                const dataB = new Date(partesB[2], partesB[1] - 1, partesB[0]);
                return dataA - dataB;
            });
            
            const contagem = labels.map(data => datas[data]);

            const ctx = document.getElementById('acionamentosTempoChart').getContext('2d');
            
            // Destruir gráfico existente se houver
            if (charts.acionamentosTempo) {
                charts.acionamentosTempo.destroy();
            }
            
            charts.acionamentosTempo = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Acionamentos',
                        data: contagem,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                color: '#444'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#444'
                            },
                            title: {
                                display: true,
                                text: 'Quantidade de Acionamentos'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Função para atualizar a tabela de detalhes
        function atualizarTabelaDetalhes() {
            const dadosParaTabela = dadosFiltrados.length > 0 ? dadosFiltrados : dados;
            const tbody = document.getElementById('detalhesTableBody');
            tbody.innerHTML = '';
            
            // Ordenar por data (mais recente primeiro)
            const dadosOrdenados = [...dadosParaTabela].sort((a, b) => {
                const dataA = parseDateTime(a['Data acionamento'], a['Hora início atendimento']);
                const dataB = parseDateTime(b['Data acionamento'], b['Hora início atendimento']);
                return dataB - dataA;
            });
            
            // Calcular paginação
            const totalPaginas = Math.ceil(dadosOrdenados.length / ITENS_POR_PAGINA);
            const inicio = (paginaAtual - 1) * ITENS_POR_PAGINA;
            const fim = inicio + ITENS_POR_PAGINA;
            const dadosPagina = dadosOrdenados.slice(inicio, fim);
            
            // Preencher tabela
            dadosPagina.forEach(item => {
                const tr = document.createElement('tr');
                
                // Formatar data
                let dataFormatada = item['Data acionamento'] || 'N/A';
                
                // Formatar status
                let statusBadge = '';
                if (item.Status === 'Resolvido') {
                    statusBadge = '<span class="badge bg-success">Resolvido</span>';
                } else if (item.Status === 'Em Andamento') {
                    statusBadge = '<span class="badge bg-warning">Em Andamento</span>';
                } else {
                    statusBadge = '<span class="badge bg-danger">Pendente</span>';
                }
                
                tr.innerHTML = `
                    <td>${item.Id || 'N/A'}</td>
                    <td>${dataFormatada}</td>
                    <td>${item.Nome}</td>
                    <td>${item.EMPRESA}</td>
                    <td>${item.Sistema}</td>
                    <td>${item.AreaSolicitante}</td>
                    <td>${statusBadge}</td>
                    <td>${item.tempoResolucao || 'N/A'} min</td>
                    <td>
                        <button class="btn btn-sm btn-outline-light" onclick="visualizarDetalhes(${item.Id})">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });
            
            document.getElementById('tableCount').textContent = dadosOrdenados.length;
            
            // Atualizar paginação
            atualizarPaginacao(totalPaginas);
        }

        // Função para atualizar a paginação
        function atualizarPaginacao(totalPaginas) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            
            // Botão anterior
            const liPrev = document.createElement('li');
            liPrev.className = `page-item ${paginaAtual === 1 ? 'disabled' : ''}`;
            liPrev.innerHTML = `<a class="page-link" href="#" data-page="${paginaAtual - 1}">Anterior</a>`;
            pagination.appendChild(liPrev);
            
            // Páginas
            for (let i = 1; i <= totalPaginas; i++) {
                const li = document.createElement('li');
                li.className = `page-item ${i === paginaAtual ? 'active' : ''}`;
                li.innerHTML = `<a class="page-link" href="#" data-page="${i}">${i}</a>`;
                pagination.appendChild(li);
            }
            
            // Botão próximo
            const liNext = document.createElement('li');
            liNext.className = `page-item ${paginaAtual === totalPaginas ? 'disabled' : ''}`;
            liNext.innerHTML = `<a class="page-link" href="#" data-page="${paginaAtual + 1}">Próxima</a>`;
            pagination.appendChild(liNext);
            
            // Adicionar event listeners para os links de paginação
            pagination.querySelectorAll('.page-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = parseInt(this.getAttribute('data-page'));
                    if (page >= 1 && page <= totalPaginas) {
                        paginaAtual = page;
                        atualizarTabelaDetalhes();
                    }
                });
            });
        }

        // Função auxiliar para parse de data e hora
        function parseDateTime(dataStr, horaStr) {
            if (!dataStr || !horaStr) return null;
            
            // Formato de data: DD/MM/YYYY
            const partesData = dataStr.split('/');
            if (partesData.length !== 3) return null;
            
            const dia = parseInt(partesData[0]);
            const mes = parseInt(partesData[1]) - 1; // Meses são 0-indexados
            const ano = parseInt(partesData[2]);
            
            // Formato de hora: HH:MM ou HH:MM:SS
            const partesHora = horaStr.split(':');
            const hora = parseInt(partesHora[0]);
            const minuto = parseInt(partesHora[1]);
            const segundo = partesHora.length > 2 ? parseInt(partesHora[2]) : 0;
            
            return new Date(ano, mes, dia, hora, minuto, segundo);
        }

        // Função para visualizar detalhes de um acionamento
        function visualizarDetalhes(id) {
            const item = dados.find(d => d.Id == id);
            if (!item) return;
            
            // Criar modal de detalhes (simplificado)
            alert(`Detalhes do Acionamento ${id}\n\nData: ${item['Data acionamento']}\nColaborador: ${item.Nome}\nEmpresa: ${item.EMPRESA}\nSistema: ${item.Sistema}\nÁrea: ${item.AreaSolicitante}\nStatus: ${item.Status}\nTempo: ${item.tempoResolucao} min`);
        }

        // Função para expandir gráfico em modal
        function expandirGrafico(chartId) {
            const chart = charts[chartId];
            if (!chart) return;
            
            // Clonar o gráfico para o modal
            const modalCanvas = document.getElementById('modalChartCanvas');
            const modalTitle = document.getElementById('chartModalTitle');
            
            // Definir título baseado no ID do gráfico
            const titulos = {
                'eficienciaColaboradorChart': 'Eficiência por Colaborador',
                'acionamentosEmpresaChart': 'Acionamentos por Empresa',
                'performanceMensalChart': 'Performance Mensal',
                'acionamentosTempoChart': 'Acionamentos ao Longo do Tempo'
            };
            
            modalTitle.textContent = titulos[chartId] || 'Gráfico';
            
            // Destruir gráfico anterior no modal
            if (charts.modalChart) {
                charts.modalChart.destroy();
            }
            
            // Criar novo gráfico no modal
            const ctx = modalCanvas.getContext('2d');
            charts.modalChart = new Chart(ctx, {
                type: chart.config.type,
                data: JSON.parse(JSON.stringify(chart.data)), // Deep clone
                options: {
                    ...chart.options,
                    maintainAspectRatio: false,
                    responsive: true
                }
            });
            
            // Mostrar modal
            const modal = new bootstrap.Modal(document.getElementById('chartModal'));
            modal.show();
        }

        // Função para exportar a tabela
        function exportarTabela() {
            const dadosParaExportar = dadosFiltrados.length > 0 ? dadosFiltrados : dados;
            
            if (dadosParaExportar.length === 0) {
                mostrarStatus('Nenhum dado para exportar.', 'warning');
                return;
            }
            
            // Criar CSV
            const headers = ['Id', 'Data acionamento', 'Nome', 'EMPRESA', 'Sistema', 'Área Solicitante', 'Status', 'Tempo (min)'];
            const csvRows = [headers.join(';')];
            
            dadosParaExportar.forEach(item => {
                const row = [
                    item.Id || '',
                    item['Data acionamento'] || '',
                    item.Nome || '',
                    item.EMPRESA || '',
                    item.Sistema || '',
                    item.AreaSolicitante || '',
                    item.Status || '',
                    item.tempoResolucao || ''
                ];
                csvRows.push(row.join(';'));
            });
            
            const csvString = csvRows.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `acionamentos_scada_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            mostrarStatus('Tabela exportada com sucesso!', 'success');
        }

        // NOVAS FUNÇÕES PARA O SISTEMA DE PDF

        // Função para mostrar pré-visualização do PDF
        function mostrarPreviaPDF() {
            const previewContent = document.getElementById('pdfPreviewContent');
            
            // Gerar conteúdo da pré-visualização
            let previewHTML = `
                <h1>Relatório de Acionamentos SCADA/ADMS - Energisa</h1>
                <p><strong>Data do Relatório:</strong> ${new Date().toLocaleDateString('pt-BR')}</p>
                <p><strong>Período Analisado:</strong> ${obterPeriodoAnalisado()}</p>
                <p><strong>Total de Registros:</strong> ${dadosFiltrados.length}</p>
                
                <div class="summary-section">
                    <h2>Resumo Executivo</h2>
                    <p>Este relatório apresenta uma análise detalhada dos acionamentos realizados pelo time SCADA/ADMS da Energisa. 
                    No período analisado, foram registrados <strong>${document.getElementById('totalAcionamentos').textContent} acionamentos</strong>, 
                    com uma taxa de sucesso de <strong>${document.getElementById('taxaSucesso').textContent}</strong> 
                    e tempo médio de resposta de <strong>${document.getElementById('mediaTempo').textContent}</strong>.</p>
                    
                    <p>Dos acionamentos realizados, <strong>${document.getElementById('scadaApenas').textContent}</strong> 
                    foram resolvidos exclusivamente pelo time SCADA, representando uma economia significativa de recursos 
                    ao evitar o acionamento de outras equipes especializadas.</p>
                </div>
                
                <h2>Análise Detalhada dos Indicadores</h2>
                
                <h3>Eficiência por Colaborador</h3>
                <div class="chart-preview">
                    <p><em>Gráfico de barras combinado com linha mostrando taxa de sucesso e tempo médio por colaborador</em></p>
                    <p>Este gráfico permite identificar os colaboradores com melhor desempenho em termos de taxa de resolução 
                    e tempo médio de atendimento. A análise revela padrões de eficiência que podem ser replicados como 
                    melhores práticas pela equipe.</p>
                </div>
                
                <h3>Acionamentos por Empresa</h3>
                <div class="chart-preview">
                    <p><em>Gráfico de barras empilhadas mostrando acionamentos resolvidos e pendentes por empresa</em></p>
                    <p>A distribuição por empresa ajuda a identificar quais unidades demandam maior suporte do time SCADA, 
                    permitindo otimizar a alocação de recursos e identificar oportunidades de capacitação local.</p>
                </div>
                
                <h3>Performance Mensal</h3>
                <div class="chart-preview">
                    <p><em>Gráfico de linhas mostrando evolução da taxa de sucesso e tempo médio ao longo dos meses</em></p>
                    <p>A tendência temporal revela a evolução da performance da equipe, destacando períodos de melhoria 
                    ou degradação que podem estar relacionados a mudanças processuais, treinamentos ou sazonalidades.</p>
                </div>
                
                <h3>Acionamentos ao Longo do Tempo</h3>
                <div class="chart-preview">
                    <p><em>Gráfico de área mostrando volume diário de acionamentos</em></p>
                    <p>Esta visualização identifica picos de demanda que podem estar relacionados a eventos específicos, 
                    falhas sistêmicas ou períodos de maior criticidade operacional.</p>
                </div>
                
                <h2>Insights e Recomendações</h2>
                <ul>
                    <li><strong>Otimização de Processos:</strong> Identificar e padronizar as melhores práticas dos colaboradores com maior taxa de sucesso</li>
                    <li><strong>Capacitação:</strong> Desenvolver treinamentos específicos para os tipos de acionamentos mais frequentes</li>
                    <li><strong>Alocação de Recursos:</strong> Distribuir a equipe conforme a demanda por empresa e horários de pico</li>
                    <li><strong>Metas de Performance:</strong> Estabelecer metas individuais baseadas na análise comparativa entre colaboradores</li>
                    <li><strong>Monitoramento Contínuo:</strong> Implementar alertas para indicadores que se aproximem dos limites estabelecidos</li>
                </ul>
                
                <h2>Considerações Finais</h2>
                <p>Os dados analisados demonstram a efetividade das operações do time SCADA/ADMS, com indicadores 
                consistentes dentro dos parâmetros estabelecidos. As oportunidades de melhoria identificadas representam 
                caminhos para elevar ainda mais o padrão de excelência do serviço prestado.</p>
                
                <p><strong>Próximos Passos:</strong> Recomenda-se a revisão trimestral destes indicadores com as equipes 
                envolvidas e a implementação gradual das melhorias propostas, com monitoramento contínuo dos resultados.</p>
            `;
            
            previewContent.innerHTML = previewHTML;
            
            // Mostrar o modal
            const pdfPreviewModal = new bootstrap.Modal(document.getElementById('pdfPreviewModal'));
            pdfPreviewModal.show();
        }

        // Função para obter o período analisado
        function obterPeriodoAnalisado() {
            const dataInicio = document.getElementById('dataInicioFilter').value;
            const dataFim = document.getElementById('dataFimFilter').value;
            
            if (dataInicio && dataFim) {
                return `${new Date(dataInicio).toLocaleDateString('pt-BR')} a ${new Date(dataFim).toLocaleDateString('pt-BR')}`;
            }
            
            return 'Período completo dos dados';
        }

        // Função para gerar o PDF
        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configurações iniciais
            doc.setFontSize(16);
            doc.setTextColor(40, 40, 40);
            doc.text('Relatório de Acionamentos SCADA/ADMS - Energisa', 20, 20);
            
            doc.setFontSize(10);
            doc.text(`Data do Relatório: ${new Date().toLocaleDateString('pt-BR')}`, 20, 30);
            doc.text(`Período Analisado: ${obterPeriodoAnalisado()}`, 20, 37);
            doc.text(`Total de Registros: ${dadosFiltrados.length}`, 20, 44);
            
            // Resumo Executivo
            let yPosition = 60;
            doc.setFontSize(12);
            doc.setTextColor(26, 117, 188);
            doc.text('Resumo Executivo', 20, yPosition);
            
            yPosition += 10;
            doc.setFontSize(10);
            doc.setTextColor(40, 40, 40);
            const resumoText = `Este relatório apresenta uma análise detalhada dos acionamentos realizados pelo time SCADA/ADMS da Energisa. 
            No período analisado, foram registrados ${document.getElementById('totalAcionamentos').textContent} acionamentos, 
            com uma taxa de sucesso de ${document.getElementById('taxaSucesso').textContent} 
            e tempo médio de resposta de ${document.getElementById('mediaTempo').textContent}.`;
            
            const splitResumo = doc.splitTextToSize(resumoText, 170);
            doc.text(splitResumo, 20, yPosition);
            
            yPosition += splitResumo.length * 5 + 5;
            
            const resumo2Text = `Dos acionamentos realizados, ${document.getElementById('scadaApenas').textContent} 
            foram resolvidos exclusivamente pelo time SCADA, representando uma economia significativa de recursos 
            ao evitar o acionamento de outras equipes especializadas.`;
            
            const splitResumo2 = doc.splitTextToSize(resumo2Text, 170);
            doc.text(splitResumo2, 20, yPosition);
            
            // Análise dos Gráficos
            yPosition += splitResumo2.length * 5 + 15;
            doc.setFontSize(12);
            doc.setTextColor(26, 117, 188);
            doc.text('Análise dos Principais Indicadores', 20, yPosition);
            
            yPosition += 10;
            doc.setFontSize(10);
            doc.setTextColor(40, 40, 40);
            
            const analises = [
                '• Eficiência por Colaborador: Identifica desempenho individual em taxa de sucesso e tempo médio',
                '• Acionamentos por Empresa: Mostra distribuição de demanda entre unidades',
                '• Performance Mensal: Revela tendências temporais da eficiência operacional',
                '• Acionamentos ao Longo do Tempo: Identifica padrões sazonais e picos de demanda'
            ];
            
            analises.forEach(analise => {
                if (yPosition > 250) {
                    doc.addPage();
                    yPosition = 20;
                }
                doc.text(analise, 25, yPosition);
                yPosition += 7;
            });
            
            // Insights e Recomendações
            yPosition += 10;
            if (yPosition > 250) {
                doc.addPage();
                yPosition = 20;
            }
            
            doc.setFontSize(12);
            doc.setTextColor(26, 117, 188);
            doc.text('Insights e Recomendações', 20, yPosition);
            
            yPosition += 10;
            doc.setFontSize(10);
            doc.setTextColor(40, 40, 40);
            
            const recomendacoes = [
                'Otimizar processos baseando-se nas melhores práticas identificadas',
                'Desenvolver treinamentos específicos para acionamentos frequentes',
                'Distribuir equipe conforme demanda por empresa e horários de pico',
                'Estabelecer metas individuais de performance',
                'Implementar monitoramento contínuo de indicadores-chave'
            ];
            
            recomendacoes.forEach(rec => {
                if (yPosition > 250) {
                    doc.addPage();
                    yPosition = 20;
                }
                doc.text('• ' + rec, 25, yPosition);
                yPosition += 7;
            });
            
            // Considerações Finais
            yPosition += 10;
            if (yPosition > 250) {
                doc.addPage();
                yPosition = 20;
            }
            
            doc.setFontSize(12);
            doc.setTextColor(26, 117, 188);
            doc.text('Considerações Finais', 20, yPosition);
            
            yPosition += 10;
            doc.setFontSize(10);
            doc.setTextColor(40, 40, 40);
            
            const consideracoesText = `Os dados analisados demonstram a efetividade das operações do time SCADA/ADMS, 
            com indicadores consistentes dentro dos parâmetros estabelecidos. Recomenda-se a revisão trimestral 
            destes indicadores e a implementação gradual das melhorias propostas.`;
            
            const splitConsideracoes = doc.splitTextToSize(consideracoesText, 170);
            doc.text(splitConsideracoes, 20, yPosition);
            
            // Salvar o PDF
            doc.save(`relatorio_scada_${new Date().toISOString().slice(0, 10)}.pdf`);
            
            // Fechar o modal
            const pdfPreviewModal = bootstrap.Modal.getInstance(document.getElementById('pdfPreviewModal'));
            pdfPreviewModal.hide();
            
            mostrarStatus('PDF gerado com sucesso!', 'success');
        }
    </script>
</body>
</html>
